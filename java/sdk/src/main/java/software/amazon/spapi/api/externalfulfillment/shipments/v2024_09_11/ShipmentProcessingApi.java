/*
 * The Selling Partner API for Amazon External Fulfillment Shipments Processing
 * You can use the External Fulfillment Shipments API to retrieve, manage, and track shipments processed through Amazon's external fulfillment network. Use this API to get shipment details, monitor status changes, and access fulfillment requirements.
 *
 * OpenAPI spec version: 2024-09-11
 * Contact: marketplaceapitest@amazon.com
 *
 * NOTE: This class is auto generated by the swagger code generator program.
 * https://github.com/swagger-api/swagger-codegen.git
 * Do not edit the class manually.
 */

package software.amazon.spapi.api.externalfulfillment.shipments.v2024_09_11;

import com.amazon.SellingPartnerAPIAA.LWAAccessTokenCache;
import com.amazon.SellingPartnerAPIAA.LWAAccessTokenCacheImpl;
import com.amazon.SellingPartnerAPIAA.LWAAuthorizationCredentials;
import com.amazon.SellingPartnerAPIAA.LWAAuthorizationSigner;
import com.amazon.SellingPartnerAPIAA.LWAException;
import com.amazon.SellingPartnerAPIAA.RestrictedDataTokenSigner;
import com.google.gson.reflect.TypeToken;
import io.github.bucket4j.Bucket;
import java.lang.reflect.Type;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import software.amazon.spapi.ApiCallback;
import software.amazon.spapi.ApiClient;
import software.amazon.spapi.ApiException;
import software.amazon.spapi.ApiResponse;
import software.amazon.spapi.Configuration;
import software.amazon.spapi.Pair;
import software.amazon.spapi.ProgressRequestBody;
import software.amazon.spapi.StringUtil;
import software.amazon.spapi.models.externalfulfillment.shipments.v2024_09_11.InvoiceResponse;
import software.amazon.spapi.models.externalfulfillment.shipments.v2024_09_11.ModelPackage;
import software.amazon.spapi.models.externalfulfillment.shipments.v2024_09_11.PackageDeliveryStatus;
import software.amazon.spapi.models.externalfulfillment.shipments.v2024_09_11.Packages;
import software.amazon.spapi.models.externalfulfillment.shipments.v2024_09_11.ShipLabelsInput;
import software.amazon.spapi.models.externalfulfillment.shipments.v2024_09_11.ShipLabelsResponse;
import software.amazon.spapi.models.externalfulfillment.shipments.v2024_09_11.ShipmentAcknowledgementRequest;
import software.amazon.spapi.models.externalfulfillment.shipments.v2024_09_11.ShippingOptionsResponse;

public class ShipmentProcessingApi {
    private ApiClient apiClient;
    private Boolean disableRateLimiting;

    public ShipmentProcessingApi(ApiClient apiClient, Boolean disableRateLimiting) {
        this.apiClient = apiClient;
        this.disableRateLimiting = disableRateLimiting;
    }

    private final Configuration config = Configuration.get();

    public final Bucket createPackagesBucket = Bucket.builder()
            .addLimit(config.getLimit("ShipmentProcessingApi-createPackages"))
            .build();

    public final Bucket generateInvoiceBucket = Bucket.builder()
            .addLimit(config.getLimit("ShipmentProcessingApi-generateInvoice"))
            .build();

    public final Bucket generateShipLabelsBucket = Bucket.builder()
            .addLimit(config.getLimit("ShipmentProcessingApi-generateShipLabels"))
            .build();

    public final Bucket processShipmentBucket = Bucket.builder()
            .addLimit(config.getLimit("ShipmentProcessingApi-processShipment"))
            .build();

    public final Bucket retrieveInvoiceBucket = Bucket.builder()
            .addLimit(config.getLimit("ShipmentProcessingApi-retrieveInvoice"))
            .build();

    public final Bucket retrieveShippingOptionsBucket = Bucket.builder()
            .addLimit(config.getLimit("ShipmentProcessingApi-retrieveShippingOptions"))
            .build();

    public final Bucket updatePackageBucket = Bucket.builder()
            .addLimit(config.getLimit("ShipmentProcessingApi-updatePackage"))
            .build();

    public final Bucket updatePackageStatusBucket = Bucket.builder()
            .addLimit(config.getLimit("ShipmentProcessingApi-updatePackageStatus"))
            .build();

    /**
     * Build call for createPackages
     *
     * @param body A list of packages in the shipment. (required)
     * @param shipmentId The ID of the shipment. (required)
     * @param progressRequestListener Progress request listener
     * @return Call to execute
     * @throws ApiException If fail to serialize the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    private okhttp3.Call createPackagesCall(
            Packages body, String shipmentId, final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        Object localVarPostBody = body;

        // create path and map variables
        String localVarPath;
        if ("/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages"
                .equals("/uploads/2020-11-01/uploadDestinations/{resource}")) {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages"
                    .replaceAll("\\{" + "shipmentId" + "\\}", shipmentId.toString());
        } else {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages"
                    .replaceAll("\\{" + "shipmentId" + "\\}", apiClient.escapeString(shipmentId.toString()));
        }

        List<Pair> localVarQueryParams = new ArrayList<Pair>();
        List<Pair> localVarCollectionQueryParams = new ArrayList<Pair>();

        Map<String, String> localVarHeaderParams = new HashMap<String, String>();

        Map<String, Object> localVarFormParams = new HashMap<String, Object>();

        final String[] localVarAccepts = {"application/json"};
        final String localVarAccept = apiClient.selectHeaderAccept(localVarAccepts);
        if (localVarAccept != null) localVarHeaderParams.put("Accept", localVarAccept);

        final String[] localVarContentTypes = {"application/json"};
        final String localVarContentType = apiClient.selectHeaderContentType(localVarContentTypes);
        localVarHeaderParams.put("Content-Type", localVarContentType);

        return apiClient.buildCall(
                localVarPath,
                "POST",
                localVarQueryParams,
                localVarCollectionQueryParams,
                localVarPostBody,
                localVarHeaderParams,
                localVarFormParams,
                progressRequestListener);
    }

    private okhttp3.Call createPackagesValidateBeforeCall(
            Packages body, String shipmentId, final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        // verify the required parameter 'body' is set
        if (body == null) {
            throw new ApiException("Missing the required parameter 'body' when calling createPackages(Async)");
        }
        // verify the required parameter 'shipmentId' is set
        if (shipmentId == null) {
            throw new ApiException("Missing the required parameter 'shipmentId' when calling createPackages(Async)");
        }

        return createPackagesCall(body, shipmentId, progressRequestListener);
    }

    /**
     * Provide details about the packages in the specified shipment.
     *
     * @param body A list of packages in the shipment. (required)
     * @param shipmentId The ID of the shipment. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public void createPackages(Packages body, String shipmentId, String restrictedDataToken)
            throws ApiException, LWAException {
        createPackagesWithHttpInfo(body, shipmentId, restrictedDataToken);
    }

    /**
     * Provide details about the packages in the specified shipment.
     *
     * @param body A list of packages in the shipment. (required)
     * @param shipmentId The ID of the shipment. (required)
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public void createPackages(Packages body, String shipmentId) throws ApiException, LWAException {
        createPackagesWithHttpInfo(body, shipmentId, null);
    }

    /**
     * Provide details about the packages in the specified shipment.
     *
     * @param body A list of packages in the shipment. (required)
     * @param shipmentId The ID of the shipment. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ApiResponse&lt;Void&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<Void> createPackagesWithHttpInfo(Packages body, String shipmentId, String restrictedDataToken)
            throws ApiException, LWAException {
        okhttp3.Call call = createPackagesValidateBeforeCall(body, shipmentId, null);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-createPackages");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || createPackagesBucket.tryConsume(1)) {
            return apiClient.execute(call);
        } else throw new ApiException.RateLimitExceeded("createPackages operation exceeds rate limit");
    }

    /**
     * Provide details about the packages in the specified shipment.
     *
     * @param body A list of packages in the shipment. (required)
     * @param shipmentId The ID of the shipment. (required)
     * @return ApiResponse&lt;Void&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<Void> createPackagesWithHttpInfo(Packages body, String shipmentId)
            throws ApiException, LWAException {
        return createPackagesWithHttpInfo(body, shipmentId, null);
    }

    /**
     * (asynchronously) Provide details about the packages in the specified shipment.
     *
     * @param body A list of packages in the shipment. (required)
     * @param shipmentId The ID of the shipment. (required)
     * @param callback The callback to be executed when the API call finishes
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call createPackagesAsync(Packages body, String shipmentId, final ApiCallback<Void> callback)
            throws ApiException, LWAException {
        return createPackagesAsync(body, shipmentId, callback, null);
    }
    /**
     * (asynchronously) Provide details about the packages in the specified shipment.
     *
     * @param body A list of packages in the shipment. (required)
     * @param shipmentId The ID of the shipment. (required)
     * @param callback The callback to be executed when the API call finishes
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call createPackagesAsync(
            Packages body, String shipmentId, final ApiCallback<Void> callback, String restrictedDataToken)
            throws ApiException, LWAException {

        ProgressRequestBody.ProgressRequestListener progressRequestListener = null;

        if (callback != null) {
            progressRequestListener = callback::onUploadProgress;
        }

        okhttp3.Call call = createPackagesValidateBeforeCall(body, shipmentId, progressRequestListener);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-createPackages");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || createPackagesBucket.tryConsume(1)) {
            apiClient.executeAsync(call, callback);
            return call;
        } else throw new ApiException.RateLimitExceeded("createPackages operation exceeds rate limit");
    }
    /**
     * Build call for generateInvoice
     *
     * @param shipmentId The ID of the shipment whose invoice you want. (required)
     * @param progressRequestListener Progress request listener
     * @return Call to execute
     * @throws ApiException If fail to serialize the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    private okhttp3.Call generateInvoiceCall(
            String shipmentId, final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        Object localVarPostBody = null;

        // create path and map variables
        String localVarPath;
        if ("/externalFulfillment/2024-09-11/shipments/{shipmentId}/invoice"
                .equals("/uploads/2020-11-01/uploadDestinations/{resource}")) {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/invoice"
                    .replaceAll("\\{" + "shipmentId" + "\\}", shipmentId.toString());
        } else {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/invoice"
                    .replaceAll("\\{" + "shipmentId" + "\\}", apiClient.escapeString(shipmentId.toString()));
        }

        List<Pair> localVarQueryParams = new ArrayList<Pair>();
        List<Pair> localVarCollectionQueryParams = new ArrayList<Pair>();

        Map<String, String> localVarHeaderParams = new HashMap<String, String>();

        Map<String, Object> localVarFormParams = new HashMap<String, Object>();

        final String[] localVarAccepts = {"application/json"};
        final String localVarAccept = apiClient.selectHeaderAccept(localVarAccepts);
        if (localVarAccept != null) localVarHeaderParams.put("Accept", localVarAccept);

        final String[] localVarContentTypes = {};

        final String localVarContentType = apiClient.selectHeaderContentType(localVarContentTypes);
        localVarHeaderParams.put("Content-Type", localVarContentType);

        return apiClient.buildCall(
                localVarPath,
                "POST",
                localVarQueryParams,
                localVarCollectionQueryParams,
                localVarPostBody,
                localVarHeaderParams,
                localVarFormParams,
                progressRequestListener);
    }

    private okhttp3.Call generateInvoiceValidateBeforeCall(
            String shipmentId, final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        // verify the required parameter 'shipmentId' is set
        if (shipmentId == null) {
            throw new ApiException("Missing the required parameter 'shipmentId' when calling generateInvoice(Async)");
        }

        return generateInvoiceCall(shipmentId, progressRequestListener);
    }

    /**
     * Get invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return InvoiceResponse
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public InvoiceResponse generateInvoice(String shipmentId, String restrictedDataToken)
            throws ApiException, LWAException {
        ApiResponse<InvoiceResponse> resp = generateInvoiceWithHttpInfo(shipmentId, restrictedDataToken);
        return resp.getData();
    }

    /**
     * Get invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want. (required)
     * @return InvoiceResponse
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public InvoiceResponse generateInvoice(String shipmentId) throws ApiException, LWAException {
        ApiResponse<InvoiceResponse> resp = generateInvoiceWithHttpInfo(shipmentId, null);
        return resp.getData();
    }

    /**
     * Get invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ApiResponse&lt;InvoiceResponse&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<InvoiceResponse> generateInvoiceWithHttpInfo(String shipmentId, String restrictedDataToken)
            throws ApiException, LWAException {
        okhttp3.Call call = generateInvoiceValidateBeforeCall(shipmentId, null);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-generateInvoice");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || generateInvoiceBucket.tryConsume(1)) {
            Type localVarReturnType = new TypeToken<InvoiceResponse>() {}.getType();
            return apiClient.execute(call, localVarReturnType);
        } else throw new ApiException.RateLimitExceeded("generateInvoice operation exceeds rate limit");
    }

    /**
     * Get invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want. (required)
     * @return ApiResponse&lt;InvoiceResponse&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<InvoiceResponse> generateInvoiceWithHttpInfo(String shipmentId)
            throws ApiException, LWAException {
        return generateInvoiceWithHttpInfo(shipmentId, null);
    }

    /**
     * (asynchronously) Get invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want. (required)
     * @param callback The callback to be executed when the API call finishes
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call generateInvoiceAsync(String shipmentId, final ApiCallback<InvoiceResponse> callback)
            throws ApiException, LWAException {
        return generateInvoiceAsync(shipmentId, callback, null);
    }
    /**
     * (asynchronously) Get invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want. (required)
     * @param callback The callback to be executed when the API call finishes
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call generateInvoiceAsync(
            String shipmentId, final ApiCallback<InvoiceResponse> callback, String restrictedDataToken)
            throws ApiException, LWAException {

        ProgressRequestBody.ProgressRequestListener progressRequestListener = null;

        if (callback != null) {
            progressRequestListener = callback::onUploadProgress;
        }

        okhttp3.Call call = generateInvoiceValidateBeforeCall(shipmentId, progressRequestListener);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-generateInvoice");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || generateInvoiceBucket.tryConsume(1)) {
            Type localVarReturnType = new TypeToken<InvoiceResponse>() {}.getType();
            apiClient.executeAsync(call, localVarReturnType, callback);
            return call;
        } else throw new ApiException.RateLimitExceeded("generateInvoice operation exceeds rate limit");
    }
    /**
     * Build call for generateShipLabels
     *
     * @param shipmentId The ID of the shipment whose shipping labels you want to generate and retrieve. (required)
     * @param operation Specify whether you want to generate or regenerate a label. (required)
     * @param body Shipping details for when shipping is not done by the marketplace channel. (optional)
     * @param shippingOptionId The ID of the shipping option whose shipping labels you want. (optional)
     * @param progressRequestListener Progress request listener
     * @return Call to execute
     * @throws ApiException If fail to serialize the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    private okhttp3.Call generateShipLabelsCall(
            String shipmentId,
            String operation,
            ShipLabelsInput body,
            String shippingOptionId,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        Object localVarPostBody = body;

        // create path and map variables
        String localVarPath;
        if ("/externalFulfillment/2024-09-11/shipments/{shipmentId}/shipLabels"
                .equals("/uploads/2020-11-01/uploadDestinations/{resource}")) {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/shipLabels"
                    .replaceAll("\\{" + "shipmentId" + "\\}", shipmentId.toString());
        } else {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/shipLabels"
                    .replaceAll("\\{" + "shipmentId" + "\\}", apiClient.escapeString(shipmentId.toString()));
        }

        List<Pair> localVarQueryParams = new ArrayList<Pair>();
        List<Pair> localVarCollectionQueryParams = new ArrayList<Pair>();
        if (shippingOptionId != null)
            localVarQueryParams.addAll(apiClient.parameterToPair("shippingOptionId", shippingOptionId));
        if (operation != null) localVarQueryParams.addAll(apiClient.parameterToPair("operation", operation));

        Map<String, String> localVarHeaderParams = new HashMap<String, String>();

        Map<String, Object> localVarFormParams = new HashMap<String, Object>();

        final String[] localVarAccepts = {"application/json"};
        final String localVarAccept = apiClient.selectHeaderAccept(localVarAccepts);
        if (localVarAccept != null) localVarHeaderParams.put("Accept", localVarAccept);

        final String[] localVarContentTypes = {"application/json"};
        final String localVarContentType = apiClient.selectHeaderContentType(localVarContentTypes);
        localVarHeaderParams.put("Content-Type", localVarContentType);

        return apiClient.buildCall(
                localVarPath,
                "PUT",
                localVarQueryParams,
                localVarCollectionQueryParams,
                localVarPostBody,
                localVarHeaderParams,
                localVarFormParams,
                progressRequestListener);
    }

    private okhttp3.Call generateShipLabelsValidateBeforeCall(
            String shipmentId,
            String operation,
            ShipLabelsInput body,
            String shippingOptionId,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        // verify the required parameter 'shipmentId' is set
        if (shipmentId == null) {
            throw new ApiException(
                    "Missing the required parameter 'shipmentId' when calling generateShipLabels(Async)");
        }
        // verify the required parameter 'operation' is set
        if (operation == null) {
            throw new ApiException("Missing the required parameter 'operation' when calling generateShipLabels(Async)");
        }

        return generateShipLabelsCall(shipmentId, operation, body, shippingOptionId, progressRequestListener);
    }

    /**
     * Generate and retrieve all shipping labels for one or more packages in the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose shipping labels you want to generate and retrieve. (required)
     * @param operation Specify whether you want to generate or regenerate a label. (required)
     * @param body Shipping details for when shipping is not done by the marketplace channel. (optional)
     * @param shippingOptionId The ID of the shipping option whose shipping labels you want. (optional)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ShipLabelsResponse
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ShipLabelsResponse generateShipLabels(
            String shipmentId,
            String operation,
            ShipLabelsInput body,
            String shippingOptionId,
            String restrictedDataToken)
            throws ApiException, LWAException {
        ApiResponse<ShipLabelsResponse> resp =
                generateShipLabelsWithHttpInfo(shipmentId, operation, body, shippingOptionId, restrictedDataToken);
        return resp.getData();
    }

    /**
     * Generate and retrieve all shipping labels for one or more packages in the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose shipping labels you want to generate and retrieve. (required)
     * @param operation Specify whether you want to generate or regenerate a label. (required)
     * @param body Shipping details for when shipping is not done by the marketplace channel. (optional)
     * @param shippingOptionId The ID of the shipping option whose shipping labels you want. (optional)
     * @return ShipLabelsResponse
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ShipLabelsResponse generateShipLabels(
            String shipmentId, String operation, ShipLabelsInput body, String shippingOptionId)
            throws ApiException, LWAException {
        ApiResponse<ShipLabelsResponse> resp =
                generateShipLabelsWithHttpInfo(shipmentId, operation, body, shippingOptionId, null);
        return resp.getData();
    }

    /**
     * Generate and retrieve all shipping labels for one or more packages in the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose shipping labels you want to generate and retrieve. (required)
     * @param operation Specify whether you want to generate or regenerate a label. (required)
     * @param body Shipping details for when shipping is not done by the marketplace channel. (optional)
     * @param shippingOptionId The ID of the shipping option whose shipping labels you want. (optional)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ApiResponse&lt;ShipLabelsResponse&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<ShipLabelsResponse> generateShipLabelsWithHttpInfo(
            String shipmentId,
            String operation,
            ShipLabelsInput body,
            String shippingOptionId,
            String restrictedDataToken)
            throws ApiException, LWAException {
        okhttp3.Call call = generateShipLabelsValidateBeforeCall(shipmentId, operation, body, shippingOptionId, null);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-generateShipLabels");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || generateShipLabelsBucket.tryConsume(1)) {
            Type localVarReturnType = new TypeToken<ShipLabelsResponse>() {}.getType();
            return apiClient.execute(call, localVarReturnType);
        } else throw new ApiException.RateLimitExceeded("generateShipLabels operation exceeds rate limit");
    }

    /**
     * Generate and retrieve all shipping labels for one or more packages in the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose shipping labels you want to generate and retrieve. (required)
     * @param operation Specify whether you want to generate or regenerate a label. (required)
     * @param body Shipping details for when shipping is not done by the marketplace channel. (optional)
     * @param shippingOptionId The ID of the shipping option whose shipping labels you want. (optional)
     * @return ApiResponse&lt;ShipLabelsResponse&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<ShipLabelsResponse> generateShipLabelsWithHttpInfo(
            String shipmentId, String operation, ShipLabelsInput body, String shippingOptionId)
            throws ApiException, LWAException {
        return generateShipLabelsWithHttpInfo(shipmentId, operation, body, shippingOptionId, null);
    }

    /**
     * (asynchronously) Generate and retrieve all shipping labels for one or more packages in the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose shipping labels you want to generate and retrieve. (required)
     * @param operation Specify whether you want to generate or regenerate a label. (required)
     * @param body Shipping details for when shipping is not done by the marketplace channel. (optional)
     * @param shippingOptionId The ID of the shipping option whose shipping labels you want. (optional)
     * @param callback The callback to be executed when the API call finishes
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call generateShipLabelsAsync(
            String shipmentId,
            String operation,
            ShipLabelsInput body,
            String shippingOptionId,
            final ApiCallback<ShipLabelsResponse> callback)
            throws ApiException, LWAException {
        return generateShipLabelsAsync(shipmentId, operation, body, shippingOptionId, callback, null);
    }
    /**
     * (asynchronously) Generate and retrieve all shipping labels for one or more packages in the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose shipping labels you want to generate and retrieve. (required)
     * @param operation Specify whether you want to generate or regenerate a label. (required)
     * @param body Shipping details for when shipping is not done by the marketplace channel. (optional)
     * @param shippingOptionId The ID of the shipping option whose shipping labels you want. (optional)
     * @param callback The callback to be executed when the API call finishes
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call generateShipLabelsAsync(
            String shipmentId,
            String operation,
            ShipLabelsInput body,
            String shippingOptionId,
            final ApiCallback<ShipLabelsResponse> callback,
            String restrictedDataToken)
            throws ApiException, LWAException {

        ProgressRequestBody.ProgressRequestListener progressRequestListener = null;

        if (callback != null) {
            progressRequestListener = callback::onUploadProgress;
        }

        okhttp3.Call call = generateShipLabelsValidateBeforeCall(
                shipmentId, operation, body, shippingOptionId, progressRequestListener);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-generateShipLabels");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || generateShipLabelsBucket.tryConsume(1)) {
            Type localVarReturnType = new TypeToken<ShipLabelsResponse>() {}.getType();
            apiClient.executeAsync(call, localVarReturnType, callback);
            return call;
        } else throw new ApiException.RateLimitExceeded("generateShipLabels operation exceeds rate limit");
    }
    /**
     * Build call for processShipment
     *
     * @param shipmentId The ID of the shipment you want to confirm or reject. (required)
     * @param operation The status of the shipment. (required)
     * @param body Information about the shipment and its line items. (optional)
     * @param progressRequestListener Progress request listener
     * @return Call to execute
     * @throws ApiException If fail to serialize the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    private okhttp3.Call processShipmentCall(
            String shipmentId,
            String operation,
            ShipmentAcknowledgementRequest body,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        Object localVarPostBody = body;

        // create path and map variables
        String localVarPath;
        if ("/externalFulfillment/2024-09-11/shipments/{shipmentId}"
                .equals("/uploads/2020-11-01/uploadDestinations/{resource}")) {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}"
                    .replaceAll("\\{" + "shipmentId" + "\\}", shipmentId.toString());
        } else {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}"
                    .replaceAll("\\{" + "shipmentId" + "\\}", apiClient.escapeString(shipmentId.toString()));
        }

        List<Pair> localVarQueryParams = new ArrayList<Pair>();
        List<Pair> localVarCollectionQueryParams = new ArrayList<Pair>();
        if (operation != null) localVarQueryParams.addAll(apiClient.parameterToPair("operation", operation));

        Map<String, String> localVarHeaderParams = new HashMap<String, String>();

        Map<String, Object> localVarFormParams = new HashMap<String, Object>();

        final String[] localVarAccepts = {"application/json"};
        final String localVarAccept = apiClient.selectHeaderAccept(localVarAccepts);
        if (localVarAccept != null) localVarHeaderParams.put("Accept", localVarAccept);

        final String[] localVarContentTypes = {"application/json"};
        final String localVarContentType = apiClient.selectHeaderContentType(localVarContentTypes);
        localVarHeaderParams.put("Content-Type", localVarContentType);

        return apiClient.buildCall(
                localVarPath,
                "POST",
                localVarQueryParams,
                localVarCollectionQueryParams,
                localVarPostBody,
                localVarHeaderParams,
                localVarFormParams,
                progressRequestListener);
    }

    private okhttp3.Call processShipmentValidateBeforeCall(
            String shipmentId,
            String operation,
            ShipmentAcknowledgementRequest body,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        // verify the required parameter 'shipmentId' is set
        if (shipmentId == null) {
            throw new ApiException("Missing the required parameter 'shipmentId' when calling processShipment(Async)");
        }
        // verify the required parameter 'operation' is set
        if (operation == null) {
            throw new ApiException("Missing the required parameter 'operation' when calling processShipment(Async)");
        }

        return processShipmentCall(shipmentId, operation, body, progressRequestListener);
    }

    /**
     * Confirm or reject the specified shipment.
     *
     * @param shipmentId The ID of the shipment you want to confirm or reject. (required)
     * @param operation The status of the shipment. (required)
     * @param body Information about the shipment and its line items. (optional)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public void processShipment(
            String shipmentId, String operation, ShipmentAcknowledgementRequest body, String restrictedDataToken)
            throws ApiException, LWAException {
        processShipmentWithHttpInfo(shipmentId, operation, body, restrictedDataToken);
    }

    /**
     * Confirm or reject the specified shipment.
     *
     * @param shipmentId The ID of the shipment you want to confirm or reject. (required)
     * @param operation The status of the shipment. (required)
     * @param body Information about the shipment and its line items. (optional)
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public void processShipment(String shipmentId, String operation, ShipmentAcknowledgementRequest body)
            throws ApiException, LWAException {
        processShipmentWithHttpInfo(shipmentId, operation, body, null);
    }

    /**
     * Confirm or reject the specified shipment.
     *
     * @param shipmentId The ID of the shipment you want to confirm or reject. (required)
     * @param operation The status of the shipment. (required)
     * @param body Information about the shipment and its line items. (optional)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ApiResponse&lt;Void&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<Void> processShipmentWithHttpInfo(
            String shipmentId, String operation, ShipmentAcknowledgementRequest body, String restrictedDataToken)
            throws ApiException, LWAException {
        okhttp3.Call call = processShipmentValidateBeforeCall(shipmentId, operation, body, null);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-processShipment");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || processShipmentBucket.tryConsume(1)) {
            return apiClient.execute(call);
        } else throw new ApiException.RateLimitExceeded("processShipment operation exceeds rate limit");
    }

    /**
     * Confirm or reject the specified shipment.
     *
     * @param shipmentId The ID of the shipment you want to confirm or reject. (required)
     * @param operation The status of the shipment. (required)
     * @param body Information about the shipment and its line items. (optional)
     * @return ApiResponse&lt;Void&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<Void> processShipmentWithHttpInfo(
            String shipmentId, String operation, ShipmentAcknowledgementRequest body)
            throws ApiException, LWAException {
        return processShipmentWithHttpInfo(shipmentId, operation, body, null);
    }

    /**
     * (asynchronously) Confirm or reject the specified shipment.
     *
     * @param shipmentId The ID of the shipment you want to confirm or reject. (required)
     * @param operation The status of the shipment. (required)
     * @param body Information about the shipment and its line items. (optional)
     * @param callback The callback to be executed when the API call finishes
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call processShipmentAsync(
            String shipmentId, String operation, ShipmentAcknowledgementRequest body, final ApiCallback<Void> callback)
            throws ApiException, LWAException {
        return processShipmentAsync(shipmentId, operation, body, callback, null);
    }
    /**
     * (asynchronously) Confirm or reject the specified shipment.
     *
     * @param shipmentId The ID of the shipment you want to confirm or reject. (required)
     * @param operation The status of the shipment. (required)
     * @param body Information about the shipment and its line items. (optional)
     * @param callback The callback to be executed when the API call finishes
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call processShipmentAsync(
            String shipmentId,
            String operation,
            ShipmentAcknowledgementRequest body,
            final ApiCallback<Void> callback,
            String restrictedDataToken)
            throws ApiException, LWAException {

        ProgressRequestBody.ProgressRequestListener progressRequestListener = null;

        if (callback != null) {
            progressRequestListener = callback::onUploadProgress;
        }

        okhttp3.Call call = processShipmentValidateBeforeCall(shipmentId, operation, body, progressRequestListener);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-processShipment");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || processShipmentBucket.tryConsume(1)) {
            apiClient.executeAsync(call, callback);
            return call;
        } else throw new ApiException.RateLimitExceeded("processShipment operation exceeds rate limit");
    }
    /**
     * Build call for retrieveInvoice
     *
     * @param shipmentId The ID of the shipment whose invoice you want to retrieve. (required)
     * @param progressRequestListener Progress request listener
     * @return Call to execute
     * @throws ApiException If fail to serialize the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    private okhttp3.Call retrieveInvoiceCall(
            String shipmentId, final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        Object localVarPostBody = null;

        // create path and map variables
        String localVarPath;
        if ("/externalFulfillment/2024-09-11/shipments/{shipmentId}/invoice"
                .equals("/uploads/2020-11-01/uploadDestinations/{resource}")) {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/invoice"
                    .replaceAll("\\{" + "shipmentId" + "\\}", shipmentId.toString());
        } else {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/invoice"
                    .replaceAll("\\{" + "shipmentId" + "\\}", apiClient.escapeString(shipmentId.toString()));
        }

        List<Pair> localVarQueryParams = new ArrayList<Pair>();
        List<Pair> localVarCollectionQueryParams = new ArrayList<Pair>();

        Map<String, String> localVarHeaderParams = new HashMap<String, String>();

        Map<String, Object> localVarFormParams = new HashMap<String, Object>();

        final String[] localVarAccepts = {"application/json"};
        final String localVarAccept = apiClient.selectHeaderAccept(localVarAccepts);
        if (localVarAccept != null) localVarHeaderParams.put("Accept", localVarAccept);

        final String[] localVarContentTypes = {};

        final String localVarContentType = apiClient.selectHeaderContentType(localVarContentTypes);
        localVarHeaderParams.put("Content-Type", localVarContentType);

        return apiClient.buildCall(
                localVarPath,
                "GET",
                localVarQueryParams,
                localVarCollectionQueryParams,
                localVarPostBody,
                localVarHeaderParams,
                localVarFormParams,
                progressRequestListener);
    }

    private okhttp3.Call retrieveInvoiceValidateBeforeCall(
            String shipmentId, final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        // verify the required parameter 'shipmentId' is set
        if (shipmentId == null) {
            throw new ApiException("Missing the required parameter 'shipmentId' when calling retrieveInvoice(Async)");
        }

        return retrieveInvoiceCall(shipmentId, progressRequestListener);
    }

    /**
     * Retrieve invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want to retrieve. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return InvoiceResponse
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public InvoiceResponse retrieveInvoice(String shipmentId, String restrictedDataToken)
            throws ApiException, LWAException {
        ApiResponse<InvoiceResponse> resp = retrieveInvoiceWithHttpInfo(shipmentId, restrictedDataToken);
        return resp.getData();
    }

    /**
     * Retrieve invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want to retrieve. (required)
     * @return InvoiceResponse
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public InvoiceResponse retrieveInvoice(String shipmentId) throws ApiException, LWAException {
        ApiResponse<InvoiceResponse> resp = retrieveInvoiceWithHttpInfo(shipmentId, null);
        return resp.getData();
    }

    /**
     * Retrieve invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want to retrieve. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ApiResponse&lt;InvoiceResponse&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<InvoiceResponse> retrieveInvoiceWithHttpInfo(String shipmentId, String restrictedDataToken)
            throws ApiException, LWAException {
        okhttp3.Call call = retrieveInvoiceValidateBeforeCall(shipmentId, null);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-retrieveInvoice");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || retrieveInvoiceBucket.tryConsume(1)) {
            Type localVarReturnType = new TypeToken<InvoiceResponse>() {}.getType();
            return apiClient.execute(call, localVarReturnType);
        } else throw new ApiException.RateLimitExceeded("retrieveInvoice operation exceeds rate limit");
    }

    /**
     * Retrieve invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want to retrieve. (required)
     * @return ApiResponse&lt;InvoiceResponse&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<InvoiceResponse> retrieveInvoiceWithHttpInfo(String shipmentId)
            throws ApiException, LWAException {
        return retrieveInvoiceWithHttpInfo(shipmentId, null);
    }

    /**
     * (asynchronously) Retrieve invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want to retrieve. (required)
     * @param callback The callback to be executed when the API call finishes
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call retrieveInvoiceAsync(String shipmentId, final ApiCallback<InvoiceResponse> callback)
            throws ApiException, LWAException {
        return retrieveInvoiceAsync(shipmentId, callback, null);
    }
    /**
     * (asynchronously) Retrieve invoices for the shipment you specify.
     *
     * @param shipmentId The ID of the shipment whose invoice you want to retrieve. (required)
     * @param callback The callback to be executed when the API call finishes
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call retrieveInvoiceAsync(
            String shipmentId, final ApiCallback<InvoiceResponse> callback, String restrictedDataToken)
            throws ApiException, LWAException {

        ProgressRequestBody.ProgressRequestListener progressRequestListener = null;

        if (callback != null) {
            progressRequestListener = callback::onUploadProgress;
        }

        okhttp3.Call call = retrieveInvoiceValidateBeforeCall(shipmentId, progressRequestListener);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-retrieveInvoice");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || retrieveInvoiceBucket.tryConsume(1)) {
            Type localVarReturnType = new TypeToken<InvoiceResponse>() {}.getType();
            apiClient.executeAsync(call, localVarReturnType, callback);
            return call;
        } else throw new ApiException.RateLimitExceeded("retrieveInvoice operation exceeds rate limit");
    }
    /**
     * Build call for retrieveShippingOptions
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package for which you want to retrieve shipping options. (required)
     * @param progressRequestListener Progress request listener
     * @return Call to execute
     * @throws ApiException If fail to serialize the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    private okhttp3.Call retrieveShippingOptionsCall(
            String shipmentId,
            String packageId,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        Object localVarPostBody = null;

        // create path and map variables
        String localVarPath;
        if ("/externalFulfillment/2024-09-11/shipments/{shipmentId}/shippingOptions"
                .equals("/uploads/2020-11-01/uploadDestinations/{resource}")) {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/shippingOptions"
                    .replaceAll("\\{" + "shipmentId" + "\\}", shipmentId.toString());
        } else {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/shippingOptions"
                    .replaceAll("\\{" + "shipmentId" + "\\}", apiClient.escapeString(shipmentId.toString()));
        }

        List<Pair> localVarQueryParams = new ArrayList<Pair>();
        List<Pair> localVarCollectionQueryParams = new ArrayList<Pair>();
        if (packageId != null) localVarQueryParams.addAll(apiClient.parameterToPair("packageId", packageId));

        Map<String, String> localVarHeaderParams = new HashMap<String, String>();

        Map<String, Object> localVarFormParams = new HashMap<String, Object>();

        final String[] localVarAccepts = {"application/json"};
        final String localVarAccept = apiClient.selectHeaderAccept(localVarAccepts);
        if (localVarAccept != null) localVarHeaderParams.put("Accept", localVarAccept);

        final String[] localVarContentTypes = {};

        final String localVarContentType = apiClient.selectHeaderContentType(localVarContentTypes);
        localVarHeaderParams.put("Content-Type", localVarContentType);

        return apiClient.buildCall(
                localVarPath,
                "GET",
                localVarQueryParams,
                localVarCollectionQueryParams,
                localVarPostBody,
                localVarHeaderParams,
                localVarFormParams,
                progressRequestListener);
    }

    private okhttp3.Call retrieveShippingOptionsValidateBeforeCall(
            String shipmentId,
            String packageId,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        // verify the required parameter 'shipmentId' is set
        if (shipmentId == null) {
            throw new ApiException(
                    "Missing the required parameter 'shipmentId' when calling retrieveShippingOptions(Async)");
        }
        // verify the required parameter 'packageId' is set
        if (packageId == null) {
            throw new ApiException(
                    "Missing the required parameter 'packageId' when calling retrieveShippingOptions(Async)");
        }

        return retrieveShippingOptionsCall(shipmentId, packageId, progressRequestListener);
    }

    /**
     * Get a list of shipping options for a package in a shipment given the shipment&#x27;s marketplace and channel. If
     * the marketplace and channel have a pre-determined shipping option, then this operation returns an empty response.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package for which you want to retrieve shipping options. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ShippingOptionsResponse
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ShippingOptionsResponse retrieveShippingOptions(
            String shipmentId, String packageId, String restrictedDataToken) throws ApiException, LWAException {
        ApiResponse<ShippingOptionsResponse> resp =
                retrieveShippingOptionsWithHttpInfo(shipmentId, packageId, restrictedDataToken);
        return resp.getData();
    }

    /**
     * Get a list of shipping options for a package in a shipment given the shipment&#x27;s marketplace and channel. If
     * the marketplace and channel have a pre-determined shipping option, then this operation returns an empty response.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package for which you want to retrieve shipping options. (required)
     * @return ShippingOptionsResponse
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ShippingOptionsResponse retrieveShippingOptions(String shipmentId, String packageId)
            throws ApiException, LWAException {
        ApiResponse<ShippingOptionsResponse> resp = retrieveShippingOptionsWithHttpInfo(shipmentId, packageId, null);
        return resp.getData();
    }

    /**
     * Get a list of shipping options for a package in a shipment given the shipment&#x27;s marketplace and channel. If
     * the marketplace and channel have a pre-determined shipping option, then this operation returns an empty response.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package for which you want to retrieve shipping options. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ApiResponse&lt;ShippingOptionsResponse&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<ShippingOptionsResponse> retrieveShippingOptionsWithHttpInfo(
            String shipmentId, String packageId, String restrictedDataToken) throws ApiException, LWAException {
        okhttp3.Call call = retrieveShippingOptionsValidateBeforeCall(shipmentId, packageId, null);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-retrieveShippingOptions");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || retrieveShippingOptionsBucket.tryConsume(1)) {
            Type localVarReturnType = new TypeToken<ShippingOptionsResponse>() {}.getType();
            return apiClient.execute(call, localVarReturnType);
        } else throw new ApiException.RateLimitExceeded("retrieveShippingOptions operation exceeds rate limit");
    }

    /**
     * Get a list of shipping options for a package in a shipment given the shipment&#x27;s marketplace and channel. If
     * the marketplace and channel have a pre-determined shipping option, then this operation returns an empty response.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package for which you want to retrieve shipping options. (required)
     * @return ApiResponse&lt;ShippingOptionsResponse&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<ShippingOptionsResponse> retrieveShippingOptionsWithHttpInfo(String shipmentId, String packageId)
            throws ApiException, LWAException {
        return retrieveShippingOptionsWithHttpInfo(shipmentId, packageId, null);
    }

    /**
     * (asynchronously) Get a list of shipping options for a package in a shipment given the shipment&#x27;s marketplace
     * and channel. If the marketplace and channel have a pre-determined shipping option, then this operation returns an
     * empty response.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package for which you want to retrieve shipping options. (required)
     * @param callback The callback to be executed when the API call finishes
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call retrieveShippingOptionsAsync(
            String shipmentId, String packageId, final ApiCallback<ShippingOptionsResponse> callback)
            throws ApiException, LWAException {
        return retrieveShippingOptionsAsync(shipmentId, packageId, callback, null);
    }
    /**
     * (asynchronously) Get a list of shipping options for a package in a shipment given the shipment&#x27;s marketplace
     * and channel. If the marketplace and channel have a pre-determined shipping option, then this operation returns an
     * empty response.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package for which you want to retrieve shipping options. (required)
     * @param callback The callback to be executed when the API call finishes
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call retrieveShippingOptionsAsync(
            String shipmentId,
            String packageId,
            final ApiCallback<ShippingOptionsResponse> callback,
            String restrictedDataToken)
            throws ApiException, LWAException {

        ProgressRequestBody.ProgressRequestListener progressRequestListener = null;

        if (callback != null) {
            progressRequestListener = callback::onUploadProgress;
        }

        okhttp3.Call call = retrieveShippingOptionsValidateBeforeCall(shipmentId, packageId, progressRequestListener);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-retrieveShippingOptions");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || retrieveShippingOptionsBucket.tryConsume(1)) {
            Type localVarReturnType = new TypeToken<ShippingOptionsResponse>() {}.getType();
            apiClient.executeAsync(call, localVarReturnType, callback);
            return call;
        } else throw new ApiException.RateLimitExceeded("retrieveShippingOptions operation exceeds rate limit");
    }
    /**
     * Build call for updatePackage
     *
     * @param body The body of the request. (required)
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose information you want to update. (required)
     * @param progressRequestListener Progress request listener
     * @return Call to execute
     * @throws ApiException If fail to serialize the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    private okhttp3.Call updatePackageCall(
            ModelPackage body,
            String shipmentId,
            String packageId,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        Object localVarPostBody = body;

        // create path and map variables
        String localVarPath;
        if ("/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages/{packageId}"
                .equals("/uploads/2020-11-01/uploadDestinations/{resource}")) {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages/{packageId}"
                    .replaceAll("\\{" + "shipmentId" + "\\}", shipmentId.toString())
                    .replaceAll("\\{" + "packageId" + "\\}", packageId.toString());
        } else {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages/{packageId}"
                    .replaceAll("\\{" + "shipmentId" + "\\}", apiClient.escapeString(shipmentId.toString()))
                    .replaceAll("\\{" + "packageId" + "\\}", apiClient.escapeString(packageId.toString()));
        }

        List<Pair> localVarQueryParams = new ArrayList<Pair>();
        List<Pair> localVarCollectionQueryParams = new ArrayList<Pair>();

        Map<String, String> localVarHeaderParams = new HashMap<String, String>();

        Map<String, Object> localVarFormParams = new HashMap<String, Object>();

        final String[] localVarAccepts = {"application/json"};
        final String localVarAccept = apiClient.selectHeaderAccept(localVarAccepts);
        if (localVarAccept != null) localVarHeaderParams.put("Accept", localVarAccept);

        final String[] localVarContentTypes = {"application/json"};
        final String localVarContentType = apiClient.selectHeaderContentType(localVarContentTypes);
        localVarHeaderParams.put("Content-Type", localVarContentType);

        return apiClient.buildCall(
                localVarPath,
                "PUT",
                localVarQueryParams,
                localVarCollectionQueryParams,
                localVarPostBody,
                localVarHeaderParams,
                localVarFormParams,
                progressRequestListener);
    }

    private okhttp3.Call updatePackageValidateBeforeCall(
            ModelPackage body,
            String shipmentId,
            String packageId,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        // verify the required parameter 'body' is set
        if (body == null) {
            throw new ApiException("Missing the required parameter 'body' when calling updatePackage(Async)");
        }
        // verify the required parameter 'shipmentId' is set
        if (shipmentId == null) {
            throw new ApiException("Missing the required parameter 'shipmentId' when calling updatePackage(Async)");
        }
        // verify the required parameter 'packageId' is set
        if (packageId == null) {
            throw new ApiException("Missing the required parameter 'packageId' when calling updatePackage(Async)");
        }

        return updatePackageCall(body, shipmentId, packageId, progressRequestListener);
    }

    /**
     * Updates the details about the packages that will be used to fulfill the specified shipment.
     *
     * @param body The body of the request. (required)
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose information you want to update. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public void updatePackage(ModelPackage body, String shipmentId, String packageId, String restrictedDataToken)
            throws ApiException, LWAException {
        updatePackageWithHttpInfo(body, shipmentId, packageId, restrictedDataToken);
    }

    /**
     * Updates the details about the packages that will be used to fulfill the specified shipment.
     *
     * @param body The body of the request. (required)
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose information you want to update. (required)
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public void updatePackage(ModelPackage body, String shipmentId, String packageId)
            throws ApiException, LWAException {
        updatePackageWithHttpInfo(body, shipmentId, packageId, null);
    }

    /**
     * Updates the details about the packages that will be used to fulfill the specified shipment.
     *
     * @param body The body of the request. (required)
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose information you want to update. (required)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ApiResponse&lt;Void&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<Void> updatePackageWithHttpInfo(
            ModelPackage body, String shipmentId, String packageId, String restrictedDataToken)
            throws ApiException, LWAException {
        okhttp3.Call call = updatePackageValidateBeforeCall(body, shipmentId, packageId, null);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request =
                    RestrictedDataTokenSigner.sign(request, restrictedDataToken, "ShipmentProcessingApi-updatePackage");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || updatePackageBucket.tryConsume(1)) {
            return apiClient.execute(call);
        } else throw new ApiException.RateLimitExceeded("updatePackage operation exceeds rate limit");
    }

    /**
     * Updates the details about the packages that will be used to fulfill the specified shipment.
     *
     * @param body The body of the request. (required)
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose information you want to update. (required)
     * @return ApiResponse&lt;Void&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<Void> updatePackageWithHttpInfo(ModelPackage body, String shipmentId, String packageId)
            throws ApiException, LWAException {
        return updatePackageWithHttpInfo(body, shipmentId, packageId, null);
    }

    /**
     * (asynchronously) Updates the details about the packages that will be used to fulfill the specified shipment.
     *
     * @param body The body of the request. (required)
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose information you want to update. (required)
     * @param callback The callback to be executed when the API call finishes
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call updatePackageAsync(
            ModelPackage body, String shipmentId, String packageId, final ApiCallback<Void> callback)
            throws ApiException, LWAException {
        return updatePackageAsync(body, shipmentId, packageId, callback, null);
    }
    /**
     * (asynchronously) Updates the details about the packages that will be used to fulfill the specified shipment.
     *
     * @param body The body of the request. (required)
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose information you want to update. (required)
     * @param callback The callback to be executed when the API call finishes
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call updatePackageAsync(
            ModelPackage body,
            String shipmentId,
            String packageId,
            final ApiCallback<Void> callback,
            String restrictedDataToken)
            throws ApiException, LWAException {

        ProgressRequestBody.ProgressRequestListener progressRequestListener = null;

        if (callback != null) {
            progressRequestListener = callback::onUploadProgress;
        }

        okhttp3.Call call = updatePackageValidateBeforeCall(body, shipmentId, packageId, progressRequestListener);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request =
                    RestrictedDataTokenSigner.sign(request, restrictedDataToken, "ShipmentProcessingApi-updatePackage");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || updatePackageBucket.tryConsume(1)) {
            apiClient.executeAsync(call, callback);
            return call;
        } else throw new ApiException.RateLimitExceeded("updatePackage operation exceeds rate limit");
    }
    /**
     * Build call for updatePackageStatus
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose status you want to update. (required)
     * @param body The body of the request. (optional)
     * @param status **DEPRECATED**. Do not use. Package status is defined in the body parameter. (optional)
     * @param progressRequestListener Progress request listener
     * @return Call to execute
     * @throws ApiException If fail to serialize the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    private okhttp3.Call updatePackageStatusCall(
            String shipmentId,
            String packageId,
            PackageDeliveryStatus body,
            String status,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        Object localVarPostBody = body;

        // create path and map variables
        String localVarPath;
        if ("/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages/{packageId}"
                .equals("/uploads/2020-11-01/uploadDestinations/{resource}")) {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages/{packageId}"
                    .replaceAll("\\{" + "shipmentId" + "\\}", shipmentId.toString())
                    .replaceAll("\\{" + "packageId" + "\\}", packageId.toString());
        } else {
            localVarPath = "/externalFulfillment/2024-09-11/shipments/{shipmentId}/packages/{packageId}"
                    .replaceAll("\\{" + "shipmentId" + "\\}", apiClient.escapeString(shipmentId.toString()))
                    .replaceAll("\\{" + "packageId" + "\\}", apiClient.escapeString(packageId.toString()));
        }

        List<Pair> localVarQueryParams = new ArrayList<Pair>();
        List<Pair> localVarCollectionQueryParams = new ArrayList<Pair>();
        if (status != null) localVarQueryParams.addAll(apiClient.parameterToPair("status", status));

        Map<String, String> localVarHeaderParams = new HashMap<String, String>();

        Map<String, Object> localVarFormParams = new HashMap<String, Object>();

        final String[] localVarAccepts = {"application/json"};
        final String localVarAccept = apiClient.selectHeaderAccept(localVarAccepts);
        if (localVarAccept != null) localVarHeaderParams.put("Accept", localVarAccept);

        final String[] localVarContentTypes = {"application/json"};
        final String localVarContentType = apiClient.selectHeaderContentType(localVarContentTypes);
        localVarHeaderParams.put("Content-Type", localVarContentType);

        return apiClient.buildCall(
                localVarPath,
                "PATCH",
                localVarQueryParams,
                localVarCollectionQueryParams,
                localVarPostBody,
                localVarHeaderParams,
                localVarFormParams,
                progressRequestListener);
    }

    private okhttp3.Call updatePackageStatusValidateBeforeCall(
            String shipmentId,
            String packageId,
            PackageDeliveryStatus body,
            String status,
            final ProgressRequestBody.ProgressRequestListener progressRequestListener)
            throws ApiException, LWAException {
        // verify the required parameter 'shipmentId' is set
        if (shipmentId == null) {
            throw new ApiException(
                    "Missing the required parameter 'shipmentId' when calling updatePackageStatus(Async)");
        }
        // verify the required parameter 'packageId' is set
        if (packageId == null) {
            throw new ApiException(
                    "Missing the required parameter 'packageId' when calling updatePackageStatus(Async)");
        }

        return updatePackageStatusCall(shipmentId, packageId, body, status, progressRequestListener);
    }

    /**
     * Updates the status of the packages.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose status you want to update. (required)
     * @param body The body of the request. (optional)
     * @param status **DEPRECATED**. Do not use. Package status is defined in the body parameter. (optional)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public void updatePackageStatus(
            String shipmentId, String packageId, PackageDeliveryStatus body, String status, String restrictedDataToken)
            throws ApiException, LWAException {
        updatePackageStatusWithHttpInfo(shipmentId, packageId, body, status, restrictedDataToken);
    }

    /**
     * Updates the status of the packages.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose status you want to update. (required)
     * @param body The body of the request. (optional)
     * @param status **DEPRECATED**. Do not use. Package status is defined in the body parameter. (optional)
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public void updatePackageStatus(String shipmentId, String packageId, PackageDeliveryStatus body, String status)
            throws ApiException, LWAException {
        updatePackageStatusWithHttpInfo(shipmentId, packageId, body, status, null);
    }

    /**
     * Updates the status of the packages.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose status you want to update. (required)
     * @param body The body of the request. (optional)
     * @param status **DEPRECATED**. Do not use. Package status is defined in the body parameter. (optional)
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return ApiResponse&lt;Void&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<Void> updatePackageStatusWithHttpInfo(
            String shipmentId, String packageId, PackageDeliveryStatus body, String status, String restrictedDataToken)
            throws ApiException, LWAException {
        okhttp3.Call call = updatePackageStatusValidateBeforeCall(shipmentId, packageId, body, status, null);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-updatePackageStatus");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || updatePackageStatusBucket.tryConsume(1)) {
            return apiClient.execute(call);
        } else throw new ApiException.RateLimitExceeded("updatePackageStatus operation exceeds rate limit");
    }

    /**
     * Updates the status of the packages.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose status you want to update. (required)
     * @param body The body of the request. (optional)
     * @param status **DEPRECATED**. Do not use. Package status is defined in the body parameter. (optional)
     * @return ApiResponse&lt;Void&gt;
     * @throws ApiException If fail to call the API, e.g. server error or cannot deserialize the response body
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public ApiResponse<Void> updatePackageStatusWithHttpInfo(
            String shipmentId, String packageId, PackageDeliveryStatus body, String status)
            throws ApiException, LWAException {
        return updatePackageStatusWithHttpInfo(shipmentId, packageId, body, status, null);
    }

    /**
     * (asynchronously) Updates the status of the packages.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose status you want to update. (required)
     * @param body The body of the request. (optional)
     * @param status **DEPRECATED**. Do not use. Package status is defined in the body parameter. (optional)
     * @param callback The callback to be executed when the API call finishes
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call updatePackageStatusAsync(
            String shipmentId,
            String packageId,
            PackageDeliveryStatus body,
            String status,
            final ApiCallback<Void> callback)
            throws ApiException, LWAException {
        return updatePackageStatusAsync(shipmentId, packageId, body, status, callback, null);
    }
    /**
     * (asynchronously) Updates the status of the packages.
     *
     * @param shipmentId The ID of the shipment to which the package belongs. (required)
     * @param packageId The ID of the package whose status you want to update. (required)
     * @param body The body of the request. (optional)
     * @param status **DEPRECATED**. Do not use. Package status is defined in the body parameter. (optional)
     * @param callback The callback to be executed when the API call finishes
     * @param restrictedDataToken Restricted Data Token (optional)
     * @return The request call
     * @throws ApiException If fail to process the API call, e.g. serializing the request body object
     * @throws LWAException If calls to fetch LWA access token fails
     */
    public okhttp3.Call updatePackageStatusAsync(
            String shipmentId,
            String packageId,
            PackageDeliveryStatus body,
            String status,
            final ApiCallback<Void> callback,
            String restrictedDataToken)
            throws ApiException, LWAException {

        ProgressRequestBody.ProgressRequestListener progressRequestListener = null;

        if (callback != null) {
            progressRequestListener = callback::onUploadProgress;
        }

        okhttp3.Call call =
                updatePackageStatusValidateBeforeCall(shipmentId, packageId, body, status, progressRequestListener);

        if (restrictedDataToken != null) {
            okhttp3.Request request = call.request();
            request = RestrictedDataTokenSigner.sign(
                    request, restrictedDataToken, "ShipmentProcessingApi-updatePackageStatus");
            call = apiClient.getHttpClient().newCall(request);
        }

        if (disableRateLimiting || updatePackageStatusBucket.tryConsume(1)) {
            apiClient.executeAsync(call, callback);
            return call;
        } else throw new ApiException.RateLimitExceeded("updatePackageStatus operation exceeds rate limit");
    }

    public static class Builder {
        private LWAAuthorizationCredentials lwaAuthorizationCredentials;
        private String endpoint;
        private LWAAccessTokenCache lwaAccessTokenCache;
        private Boolean disableAccessTokenCache = false;
        private Boolean disableRateLimiting = false;

        public Builder lwaAuthorizationCredentials(LWAAuthorizationCredentials lwaAuthorizationCredentials) {
            this.lwaAuthorizationCredentials = lwaAuthorizationCredentials;
            return this;
        }

        public Builder endpoint(String endpoint) {
            this.endpoint = endpoint;
            return this;
        }

        public Builder lwaAccessTokenCache(LWAAccessTokenCache lwaAccessTokenCache) {
            this.lwaAccessTokenCache = lwaAccessTokenCache;
            return this;
        }

        public Builder disableAccessTokenCache() {
            this.disableAccessTokenCache = true;
            return this;
        }

        public Builder disableRateLimiting() {
            this.disableRateLimiting = true;
            return this;
        }

        public ShipmentProcessingApi build() {
            if (lwaAuthorizationCredentials == null) {
                throw new RuntimeException("LWAAuthorizationCredentials not set");
            }

            if (StringUtil.isEmpty(endpoint)) {
                throw new RuntimeException("Endpoint not set");
            }

            LWAAuthorizationSigner lwaAuthorizationSigner = null;
            if (disableAccessTokenCache) {
                lwaAuthorizationSigner = new LWAAuthorizationSigner(lwaAuthorizationCredentials);
            } else {
                if (lwaAccessTokenCache == null) {
                    lwaAccessTokenCache = new LWAAccessTokenCacheImpl();
                }
                lwaAuthorizationSigner = new LWAAuthorizationSigner(lwaAuthorizationCredentials, lwaAccessTokenCache);
            }

            return new ShipmentProcessingApi(
                    new ApiClient()
                            .setLWAAuthorizationSigner(lwaAuthorizationSigner)
                            .setBasePath(endpoint),
                    disableRateLimiting);
        }
    }
}
